<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HOÀNG HẠ CÀ MAU</title>
  <style>
    /* Các style giữ nguyên */
  </style>
</head>
<body>
  <header>
    <h1>Hoàng Hạ Cà Mau chào các bạn!</h1>
    <p>Chuyên bán các mặt hàng nông sản sạch tại CÀ MAU, 100% nuôi tự nhiên</p>
  </header>

  <nav>
    <ul>
      <!-- Các liên kết giữ nguyên -->
    </ul>
  </nav>

  <main>
    <h2>Chào mừng đến với cửa hàng Hoàng Hạ</h2>
    <p>Bán các sản phẩm nông sản sạch - tươi - ngon.</p>
    <p id="productPrice">Chọn một chuyên mục để xem giá sản phẩm.</p>
    <div class="product-grid">
      <div class="product-card">
        <img src="https://i.postimg.cc/Rhg75tLV/MAM-CA-SON.jpg" alt="Mắm cá sơn">
        <div class="product-name">Mắm cá sơn</div>
        <div class="product-price">100.000 VNĐ/kg</div>
        <div id="stock-1" class="product-stock">Còn lại: 20 sản phẩm</div>
        <button onclick="addToCart(1)">Thêm vào giỏ</button>
        <button onclick="alert('Vui lòng liên hệ: 0944.41.06.41 để đặt hàng')">Mua ngay</button>
      </div>
      <div class="product-card">
        <img src="https://i.postimg.cc/hjfxWhTR/S-p-ong.jpg" alt="Mật ong rừng (Ong Mật)">
        <div class="product-name">Mật ong rừng (Ong Mật)</div>
        <div class="product-price">450.000 VNĐ/1 lít</div>
        <div id="stock-2" class="product-stock">Còn lại: 10 sản phẩm</div>
        <button onclick="addToCart(2)">Thêm vào giỏ</button>
        <button onclick="alert('Vui lòng liên hệ: 0944.41.06.41 để đặt hàng')">Mua ngay</button>
      </div>
    </div>

    <div class="chat-container">
      <h3>🛒 Giỏ hàng của bạn</h3>
      <div id="cartItems"></div>
      <div id="totalPrice">Tổng tiền: 0 VNĐ</div>
    </div>

  </main>

  <div class="chat-container">
    <h3>Vui lòng để lại Số điện thoại, Tên, Địa chỉ, Tên loại hàng, Số lượng</h3>
    <textarea id="message" placeholder="Nhập tin nhắn của bạn tại đây..."></textarea>
    <br />
    <button onclick="sendMessage()">Gửi tin nhắn</button>
    <p class="chat-response" id="chatResponse"></p>
  </div>

  <script>
    const products = [
      { id: 1, name: "Mắm Cá Sơn", price: 100000, stock: 20 },
      { id: 2, name: "Mật Ong rừng (Ong mật)", price: 450000, stock: 10 },
    ];

    let cart = [];

    function addToCart(productId) {
      const product = products.find(p => p.id === productId);
      if (!product) return;

      if (product.stock > 0) {
        product.stock -= 1;

        const cartItem = cart.find(item => item.id === productId);
        if (cartItem) {
          cartItem.quantity += 1;
        } else {
          cart.push({ ...product, quantity: 1 });
        }

        updateProductDisplay();
        updateCartDisplay();
      } else {
        alert("Sản phẩm đã hết hàng!");
      }
    }

    function updateProductDisplay() {
      products.forEach(product => {
        const stockElement = document.getElementById(`stock-${product.id}`);
        if (stockElement) {
          stockElement.textContent = `Còn lại: ${product.stock}`;
        }
      });
    }

    function updateCartDisplay() {
      const cartContainer = document.getElementById("cartItems");
      cartContainer.innerHTML = "";

      if (cart.length === 0) {
        cartContainer.innerHTML = "<p>Giỏ hàng đang trống.</p>";
      } else {
        let total = 0;
        cart.forEach(item => {
          const div = document.createElement("div");
          div.textContent = `${item.name} - SL: ${item.quantity} - ${item.price * item.quantity} VNĐ`;
          cartContainer.appendChild(div);
          total += item.price * item.quantity;
        });
        document.getElementById("totalPrice").textContent = `Tổng tiền: ${total} VNĐ`;
      }
    }

    document.addEventListener("DOMContentLoaded", () => {
      updateProductDisplay();
    });

    function sendMessage() {
      const message = document.getElementById("message").value.trim();
      const response = document.getElementById("chatResponse");

      if (message === "") {
        response.style.color = "red";
        response.textContent = "Vui lòng nhập nội dung tin nhắn!";
        return;
      }

      const url = "https://script.google.com/macros/s/AKfycbzqJQZPddWOGcHHLpdMPxRXD17CyyUFLA1DeeiOLKrRP0qeRGqLicqtu2Z4rKaMzDLa/exec";
      const formData = new FormData();
      formData.append("message", message);

      fetch(url, { method: "POST", body: formData })
        .then(() => {
          response.style.color = "green";
          response.textContent = "Tin nhắn đã được gửi và lưu thành công!";
          document.getElementById("message").value = "";
        })
        .catch(() => {
          response.style.color = "red";
          response.textContent = "Có lỗi xảy ra. Vui lòng thử lại sau!";
        });
    }
  </script>
</body>
</html>

